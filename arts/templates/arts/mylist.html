{% extends 'arts/base.html' %}

{% block content %}

<div class="card-columns">
  {% for art in mylist %}
  <div class="card">
      <a href="{% url 'art-detail' art.id %}"><img class="card-img-top img-fluid" src="{{MEDIA_URL}}{{art.image}}"  style="width:100%;" alt="Card image cap"></a>
  
      <div class="card-text">
        {% include 'arts/like.html' %}
      </div>
  
    </div>
  {% endfor %}
</div>



<!-- いいね機能 -->
<script type="text/javascript">
  $(document).ready(function(event){
      $(document).on('click', '#like', function(event){
          event.preventDefault();
          $.ajax({
              type: 'POST',
              url: "{% url 'like' %}",
              data: {
                  'art_id': $(this).attr('name'),
                  'csrfmiddlewaretoken': '{{ csrf_token }}'},
              dataType: 'json',
              success: function(response){
                  selector = document.getElementsByName(response.art_id);
                  if(response.liked){
                      $(selector).html("<i class='fas fa-lg fa-heart'></i>");
                  }
                  else {
                      $(selector).html("<i class='far fa-lg fa-heart'></i>");
                  }
                  selector2 = document.getElementsByName(response.art_id + "-count");
                  $(selector2).text(response.count);
              }
          });
      });
  });
</script>



{% endblock %}